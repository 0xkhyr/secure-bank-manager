{% extends 'base.html' %}

{% block title %}Preview - Vérif Intégrité (Heatmap) - SecureBank{% endblock %}

{% block content %}
<div style="max-width: 1000px; margin: 24px auto;">
    <h2>Preview: Heatmap d'Anomalies</h2>
    <div class="card mt-3">
        <div class="card-body">
            <p class="text-muted">Carte de chaleur montrant la densité d'erreurs par jour (ex: 24-12-2025).</p>

            <div class="heatmap" style="display:grid; grid-template-columns: repeat(7, 1fr); gap:8px;">
                {% for day in range(1,29) %}
                {% set val = (day * 3) % 9 %}
                <div class="heat-cell heat-{{ val }}">
                    <div class="heat-day">{{ '20' + (5|string) + '-12-' + (20 + day)|string }}</div>
                    <div class="heat-count">{{ val }}</div>
                </div>
                {% endfor %}
            </div>

            <div style="margin-top:16px;">
                <strong>Légende :</strong>
                <div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
                    {% for i in range(0,9) %}
                    <div style="width:28px; height:18px; background:var(--heat-{{ i }}); border-radius:4px; text-align:center; color: #111; font-size:11px; padding-top:1px;">&nbsp;</div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.heat-cell{ background:#f8fafc; border-radius:8px; padding:8px; display:flex; flex-direction:column; justify-content:center; align-items:center; min-height:72px; }
.heat-day{ font-size:12px; color:#374151; font-weight:600; }
.heat-count{ font-size:14px; color:#111827; margin-top:6px; }
:root{
    --heat-0: #f8fafc; --heat-1: #fee2e2; --heat-2: #fecaca; --heat-3: #fca5a5; --heat-4: #f87171; --heat-5: #ef4444; --heat-6: #dc2626; --heat-7: #b91c1c; --heat-8: #7f1d1d;
}
.heat-0{ background:var(--heat-0);} .heat-1{ background:var(--heat-1);} .heat-2{ background:var(--heat-2);} .heat-3{ background:var(--heat-3);} .heat-4{ background:var(--heat-4);} .heat-5{ background:var(--heat-5);} .heat-6{ background:var(--heat-6);} .heat-7{ background:var(--heat-7);} .heat-8{ background:var(--heat-8);} 
</style>

{% endblock %}
